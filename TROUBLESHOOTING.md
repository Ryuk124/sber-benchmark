# üêõ Troubleshooting & FAQ

## üö® –ß–∞—Å—Ç—ã–µ –æ—à–∏–±–∫–∏ –∏ –∏—Ö —Ä–µ—à–µ–Ω–∏—è

### –û—à–∏–±–∫–∞ 1: "ERROR: Could not find a version that satisfies the requirement qwen-api"

**–ü—Ä–∏—á–∏–Ω–∞**: `qwen-api` –ø–∞–∫–µ—Ç –Ω–µ —Å—É—â–µ—Å—Ç–≤—É–µ—Ç –≤ PyPI

**–†–µ—à–µ–Ω–∏–µ**: –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ `openai` –≤–º–µ—Å—Ç–æ `qwen-api`
```bash
# ‚ùå –ù–µ–ø—Ä–∞–≤–∏–ª—å–Ω–æ
pip install qwen-api

# ‚úÖ –ü—Ä–∞–≤–∏–ª—å–Ω–æ
pip install openai==1.3.0
```

---

### –û—à–∏–±–∫–∞ 2: "ModuleNotFoundError: No module named 'openai'"

**–ü—Ä–∏—á–∏–Ω–∞**: –ü–∞–∫–µ—Ç –Ω–µ —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω

**–†–µ—à–µ–Ω–∏–µ**:
```bash
pip install openai==1.3.0
```

---

### –û—à–∏–±–∫–∞ 3: "OPENAI_API_KEY not found" –∏–ª–∏ "Invalid API key"

**–ü—Ä–∏—á–∏–Ω–∞**: API –∫–ª—é—á –Ω–µ —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω –∏–ª–∏ –Ω–µ–ø—Ä–∞–≤–∏–ª—å–Ω—ã–π

**–†–µ—à–µ–Ω–∏–µ**:
1. –ü–æ–ª—É—á–∏—Ç—å –∫–ª—é—á –Ω–∞ https://platform.openai.com/api-keys
2. –î–æ–±–∞–≤–∏—Ç—å –≤ `.env`:
   ```
   OPENAI_API_KEY=sk-proj-xxxxx
   ```
3. –ü–µ—Ä–µ–∑–∞–≥—Ä—É–∑–∏—Ç—å Django:
   ```bash
   python manage.py runserver
   ```

---

### –û—à–∏–±–∫–∞ 4: "Connection refused" –ø—Ä–∏ –∑–∞–ø—Ä–æ—Å–µ –∫ LLM

**–ü—Ä–∏—á–∏–Ω–∞**: LLM —Å–µ—Ä–≤–∏—Å –Ω–µ –∑–∞–ø—É—â–µ–Ω –∏–ª–∏ –Ω–µ–¥–æ—Å—Ç—É–ø–µ–Ω

**–†–µ—à–µ–Ω–∏–µ**: –°–∏—Å—Ç–µ–º–∞ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –≤–µ—Ä–Ω–µ—Ç—Å—è –∫ mock-–∞–Ω–∞–ª–∏–∑—É. –≠—Ç–æ –Ω–æ—Ä–º–∞–ª—å–Ω–æ –¥–ª—è —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏.

–î–ª—è –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è —Ä–µ–∞–ª—å–Ω–æ–≥–æ —Å–µ—Ä–≤–∏—Å–∞:
```bash
# OpenAI - –Ω–µ —Ç—Ä–µ–±—É–µ—Ç –ª–æ–∫–∞–ª—å–Ω–æ–π –Ω–∞—Å—Ç—Ä–æ–π–∫–∏
OPENAI_API_KEY=sk-...

# Ollama - —Ç—Ä–µ–±—É–µ—Ç –∑–∞–ø—É—Å–∫–∞
ollama serve  # –≤ –æ—Ç–¥–µ–ª—å–Ω–æ–º —Ç–µ—Ä–º–∏–Ω–∞–ª–µ
```

---

### –û—à–∏–±–∫–∞ 5: "Exceeds token limit"

**–ü—Ä–∏—á–∏–Ω–∞**: –¢–µ–∫—Å—Ç —Å–ª–∏—à–∫–æ–º –±–æ–ª—å—à–æ–π –¥–ª—è –∞–Ω–∞–ª–∏–∑–∞

**–†–µ—à–µ–Ω–∏–µ**: `text_parser.py` –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –æ–±—Ä–µ–∑–∞–µ—Ç —Ç–µ–∫—Å—Ç –¥–æ 2000 —Å–∏–º–≤–æ–ª–æ–≤. –≠—Ç–æ –¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ.

---

### –û—à–∏–±–∫–∞ 6: Django –º–∏–≥—Ä–∞—Ü–∏—è –Ω–µ –ø—Ä–∏–º–µ–Ω–∏–ª–∞—Å—å

**–†–µ—à–µ–Ω–∏–µ**:
```bash
# 1. –°–æ–∑–¥–∞—Ç—å –º–∏–≥—Ä–∞—Ü–∏–∏
python manage.py makemigrations apps.ai

# 2. –ü—Ä–∏–º–µ–Ω–∏—Ç—å –º–∏–≥—Ä–∞—Ü–∏–∏
python manage.py migrate apps.ai

# 3. –ü—Ä–æ–≤–µ—Ä–∏—Ç—å
python manage.py showmigrations apps.ai
```

---

### –û—à–∏–±–∫–∞ 7: React –∫–æ–º–ø–æ–Ω–µ–Ω—Ç –Ω–µ –∑–∞–≥—Ä—É–∂–∞–µ—Ç –¥–∞–Ω–Ω—ã–µ

**–ü—Ä–æ–≤–µ—Ä–∏—Ç—å**:
1. –û—Ç–∫—Ä—ã—Ç—å browser console (F12)
2. –ü—Ä–æ–≤–µ—Ä–∏—Ç—å Network tab
3. –ó–∞–ø—Ä–æ—Å –∫ `/api/ai/insights/` –¥–æ–ª–∂–µ–Ω –≤–µ—Ä–Ω—É—Ç—å 200

**–ï—Å–ª–∏ 404**:
```bash
# –ü—Ä–æ–≤–µ—Ä–∏—Ç—å URL –∫–æ–Ω—Ñ–∏–≥
python manage.py show_urls | grep ai
```

**–ï—Å–ª–∏ 500**:
```bash
# –ü—Ä–æ–≤–µ—Ä–∏—Ç—å logs
python manage.py runserver --verbosity=3
```

---

### –û—à–∏–±–∫–∞ 8: "Celery task failed"

**–ü—Ä–æ–≤–µ—Ä–∏—Ç—å**:
1. Redis –∑–∞–ø—É—â–µ–Ω?
   ```bash
   redis-cli ping  # –¥–æ–ª–∂–Ω–æ –≤—ã–≤–µ—Å—Ç–∏ PONG
   ```

2. Celery worker –∑–∞–ø—É—â–µ–Ω?
   ```bash
   celery -A config worker --loglevel=debug
   ```

3. –ü–æ—Å–º–æ—Ç—Ä–µ—Ç—å –æ—à–∏–±–∫—É:
   ```bash
   celery -A config worker --loglevel=debug
   ```

---

## üí° FAQ - –ß–∞—Å—Ç–æ –∑–∞–¥–∞–≤–∞–µ–º—ã–µ –≤–æ–ø—Ä–æ—Å—ã

### Q: –ß—Ç–æ —Ç–∞–∫–æ–µ mock-–∞–Ω–∞–ª–∏–∑?
**A**: –¢–µ—Å—Ç–æ–≤—ã–µ –¥–∞–Ω–Ω—ã–µ –¥–ª—è —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏ –±–µ–∑ —Ä–µ–∞–ª—å–Ω–æ–≥–æ LLM. –ò–¥–µ–∞–ª—å–Ω–æ –¥–ª—è –ª–æ–∫–∞–ª—å–Ω–æ–π —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏.

### Q: –ú–æ–≥—É –ª–∏ —è –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å —Å–∏—Å—Ç–µ–º—É –±–µ–∑ API –∫–ª—é—á–∞?
**A**: –î–∞! Mock-–∞–Ω–∞–ª–∏–∑ —Ä–∞–±–æ—Ç–∞–µ—Ç –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏. –ò–¥–µ–∞–ª—å–Ω–æ –¥–ª—è —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏ –∏ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è.

### Q: –ö–∞–∫–æ–π API –∫–ª—é—á –≤—ã–±—Ä–∞—Ç—å?
**A**: OpenAI GPT-3.5-turbo. –õ—É—á—à–µ–µ —Å–æ–æ—Ç–Ω–æ—à–µ–Ω–∏–µ —Ü–µ–Ω—ã –∏ –∫–∞—á–µ—Å—Ç–≤–∞, –ø—Ä–æ—Å—Ç–∞—è –Ω–∞—Å—Ç—Ä–æ–π–∫–∞.

### Q: –°–∫–æ–ª—å–∫–æ –±—É–¥–µ—Ç —Å—Ç–æ–∏—Ç—å?
**A**: OpenAI GPT-3.5-turbo: ~$0.0005 –∑–∞ –∞–Ω–∞–ª–∏–∑. –û—á–µ–Ω—å –¥–µ—à–µ–≤–æ!

### Q: –ß—Ç–æ –µ—Å–ª–∏ –∏—Å—Ç–µ—á–µ—Ç –ª–∏–º–∏—Ç –Ω–∞ API –∫–ª—é—á–µ?
**A**: –°–∏—Å—Ç–µ–º–∞ –≤–µ—Ä–Ω–µ—Ç—Å—è –∫ mock-–∞–Ω–∞–ª–∏–∑—É. –ü—Ä–æ—Å—Ç–æ —É–≤–µ–ª–∏—á–∏—Ç—å –ª–∏–º–∏—Ç –≤ –∞–∫–∫–∞—É–Ω—Ç–µ OpenAI.

### Q: –ú–æ–∂–Ω–æ –ª–∏ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –ª–æ–∫–∞–ª—å–Ω—É—é –º–æ–¥–µ–ª—å?
**A**: –î–∞! Ollama –ø–æ–∑–≤–æ–ª—è–µ—Ç –∑–∞–ø—É—Å—Ç–∏—Ç—å LLaMA2 –ø–æ–ª–Ω–æ—Å—Ç—å—é –ª–æ–∫–∞–ª—å–Ω–æ. –ë–µ—Å–ø–ª–∞—Ç–Ω–æ!

### Q: –ß—Ç–æ –µ—Å–ª–∏ –º–µ–¥–ª–µ–Ω–Ω—ã–π –∏–Ω—Ç–µ—Ä–Ω–µ—Ç?
**A**: –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ Ollama (–ª–æ–∫–∞–ª—å–Ω–æ). –ò–ª–∏ —É–≤–µ–ª–∏—á–∏—Ç—å timeout –≤ `settings.py`.

### Q: –ö–∞–∫–∞—è –º–æ–¥–µ–ª—å –ª—É—á—à–µ - GPT-3.5 –∏–ª–∏ GPT-4?
**A**: GPT-3.5: –±—ã—Å—Ç—Ä–æ –∏ –¥–µ—à–µ–≤–æ. GPT-4: –ª—É—á—à–µ –∫–∞—á–µ—Å—Ç–≤–æ–º, –Ω–æ –¥–æ—Ä–æ–∂–µ. –î–ª—è –Ω–∞—á–∞–ª–∞ –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ GPT-3.5.

### Q: –ü–æ–¥–¥–µ—Ä–∂–∏–≤–∞—é—Ç—Å—è –ª–∏ –¥—Ä—É–≥–∏–µ LLM?
**A**: –î–∞! Anthropic Claude, Ollama (–ª–æ–∫–∞–ª—å–Ω–æ), –∏ –¥—Ä—É–≥–∏–µ. –ü—Ä–∏–º–µ—Ä—ã –≤ `LLM_SETUP.md`.

---

## üîç –û—Ç–ª–∞–¥–∫–∞

### –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ

**–í–∫–ª—é—á–∏—Ç—å debug –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ**:
```python
# settings.py
LOGGING = {
    'version': 1,
    'disable_existing_loggers': False,
    'handlers': {
        'console': {
            'class': 'logging.StreamHandler',
        },
    },
    'root': {
        'handlers': ['console'],
        'level': 'DEBUG',
    },
}
```

**–ó–∞—Ç–µ–º –∑–∞–ø—É—Å—Ç–∏—Ç—å**:
```bash
python manage.py runserver --verbosity=3
```

### –ü—Ä–æ–≤–µ—Ä–∫–∞ API

**–¢–µ—Å—Ç –∞–Ω–∞–ª–∏–∑–∞**:
```bash
curl -X GET "http://localhost:8000/api/ai/analysis/" -v
```

**–¢–µ—Å—Ç –∑–∞–ø—É—Å–∫–∞ –∞–Ω–∞–ª–∏–∑–∞**:
```bash
curl -X POST "http://localhost:8000/api/ai/analysis/analyze/" \
  -H "Content-Type: application/json" \
  -d '{"competitor":"sber","product":"deposits"}' \
  -v
```

**–¢–µ—Å—Ç insights**:
```bash
curl -X GET "http://localhost:8000/api/ai/insights/?banks=sber&product=deposits" \
  -v
```

---

## üìä –ü—Ä–æ–≤–µ—Ä–∫–∞ –∑–¥–æ—Ä–æ–≤—å—è —Å–∏—Å—Ç–µ–º—ã

### Healthcheck —Å–∫—Ä–∏–ø—Ç

```bash
#!/bin/bash
echo "üîç System Health Check"
echo ""

# 1. Python
echo "‚úì Python:"
python -V

# 2. Django
echo "‚úì Django:"
python manage.py check

# 3. Database
echo "‚úì Database:"
python manage.py dbshell <<< "SELECT 1;"

# 4. Redis
echo "‚úì Redis:"
redis-cli ping

# 5. API
echo "‚úì API:"
curl -s http://localhost:8000/api/status/ | jq .

echo ""
echo "‚úÖ All checks passed!"
```

---

## üöÄ Performance Tips

### –û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è –¥–ª—è production:

1. **–ö—ç—à–∏—Ä–æ–≤–∞–Ω–∏–µ –∞–Ω–∞–ª–∏–∑–æ–≤**:
   ```python
   from django.views.decorators.cache import cache_page
   
   @cache_page(60*60*24)  # –ö—ç—à –Ω–∞ 24 —á–∞—Å–∞
   def get_recommendations(request):
       ...
   ```

2. **–ë–∞—Ç—á–∏–Ω–≥ –∑–∞–ø—Ä–æ—Å–æ–≤**:
   ```python
   # –ê–Ω–∞–ª–∏–∑–∏—Ä–æ–≤–∞—Ç—å –Ω–µ—Å–∫–æ–ª—å–∫–æ —ç–ª–µ–º–µ–Ω—Ç–æ–≤ –∑–∞ —Ä–∞–∑
   analysis_results = llm.analyze_and_store(pages[:100])
   ```

3. **–ê—Å–∏–Ω—Ö—Ä–æ–Ω–Ω—ã–µ –∑–∞–¥–∞—á–∏**:
   ```bash
   # –ó–∞–ø—É—Å–∫–∞—Ç—å –∞–Ω–∞–ª–∏–∑ –≤ —Ñ–æ–Ω–µ —Å Celery
   analyze_with_llm.delay(competitor, product, urls)
   ```

---

## üÜò –ï—Å–ª–∏ –Ω–∏—á–µ–≥–æ –Ω–µ –ø–æ–º–æ–≥–∞–µ—Ç

1. **–ü—Ä–æ–≤–µ—Ä–∏—Ç—å —Å–∏—Å—Ç–µ–º—É —Ç—Ä–µ–±–æ–≤–∞–Ω–∏–π**:
   ```bash
   python -V  # 3.11+
   pip -V     # –ø–æ—Å–ª–µ–¥–Ω–∏–π
   ```

2. **–ü–µ—Ä–µ—É—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏**:
   ```bash
   pip install -r requirements.txt --force-reinstall
   ```

3. **–û—á–∏—Å—Ç–∏—Ç—å –∫—ç—à**:
   ```bash
   rm -rf backend/__pycache__
   rm -rf backend/apps/ai/__pycache__
   ```

4. **–ü–µ—Ä–µ–∑–∞–≥—Ä—É–∑–∏—Ç—å –≤—Å—ë**:
   ```bash
   # Backend
   python manage.py migrate
   python manage.py runserver
   
   # Frontend
   npm run dev
   ```

5. **–°–æ–∑–¥–∞—Ç—å issue –Ω–∞ GitHub —Å –ª–æ–≥–∞–º–∏**:
   - –í—ã–≤–æ–¥ `python manage.py runserver`
   - –í—ã–≤–æ–¥ `npm run dev`
   - –û—à–∏–±–∫–∏ –≤ browser console (F12)

---

**–î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–∞—è –ø–æ–º–æ—â—å**: —Å–º. `LLM_SETUP.md`

